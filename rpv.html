

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="es" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="es" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Servicios de Redes Privadas de Cliente &mdash; documentación de Wireshark - 1</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script type="text/javascript" src="_static/translations.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/estilos.css" type="text/css" />
    <link rel="index" title="Índice" href="genindex.html" />
    <link rel="search" title="Búsqueda" href="search.html" />
    <link rel="next" title="Switching SILAN" href="silan.html" />
    <link rel="prev" title="Protocolo RTP" href="rtp.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Wireshark
          

          
            
            <img src="_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Linux:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="red.html">Configuración de red</a></li>
<li class="toctree-l1"><a class="reference internal" href="ip-cheatsheet.html">Comandos para la gestión de red</a></li>
</ul>
<p class="caption"><span class="caption-text">Wireshark:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="introduccion.html">Introducción a Wireshark</a></li>
<li class="toctree-l1"><a class="reference internal" href="filtrado.html">Trabajando con los paquetes capturados</a></li>
<li class="toctree-l1"><a class="reference internal" href="analyze.html">Menú Analyze</a></li>
<li class="toctree-l1"><a class="reference internal" href="estadisticas.html">Estadísticas en Wireshark</a></li>
</ul>
<p class="caption"><span class="caption-text">Protocolos</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ip.html">Protocolo IP</a></li>
<li class="toctree-l1"><a class="reference internal" href="dhcp.html">Protocolo DHCP</a></li>
<li class="toctree-l1"><a class="reference internal" href="arp.html">Protocolo ARP</a></li>
<li class="toctree-l1"><a class="reference internal" href="icmp.html">Protocolo ICMP</a></li>
<li class="toctree-l1"><a class="reference internal" href="tcp.html">Protocolo TCP</a></li>
<li class="toctree-l1"><a class="reference internal" href="dns.html">Domain Name Server - DNS</a></li>
<li class="toctree-l1"><a class="reference internal" href="sip.html">Protocolo SIP</a></li>
<li class="toctree-l1"><a class="reference internal" href="rtp.html">Protocolo RTP</a></li>
</ul>
<p class="caption"><span class="caption-text">Ibercom IP:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Servicios de Redes Privadas de Cliente</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#concepto-de-vpn">Concepto de VPN</a></li>
<li class="toctree-l2"><a class="reference internal" href="#l3vpn">L3VPN</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#concepto-l3vpn-mpls">Concepto L3VPN MPLS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#elementos-que-componen-l3vpn-mpls">Elementos que componen L3VPN MPLS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#senalizacion-l3vpn-mpls-mp-bgp">Señalización L3VPN MPLS (MP-BGP)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id1">RFC 4364</a></li>
<li class="toctree-l3"><a class="reference internal" href="#forwarding">Forwarding</a></li>
<li class="toctree-l3"><a class="reference internal" href="#servicios-rpv">Servicios RPV</a></li>
<li class="toctree-l3"><a class="reference internal" href="#red-de-trnasporte">Red de trnasporte</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#servicio-vpn-ip">Servicio VPN-IP</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#caracteristicas-del-servicio-vpn-ip">Caracteristicas del servicio VPN-IP</a></li>
<li class="toctree-l3"><a class="reference internal" href="#arquitectura">Arquitectura</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tipos-de-acceso">Tipos de acceso</a></li>
<li class="toctree-l3"><a class="reference internal" href="#equipamiento-y-tipos-de-aceso">Equipamiento y tipos de aceso</a></li>
<li class="toctree-l3"><a class="reference internal" href="#escenarios">Escenarios</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">Servicio VPN-IP</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#macrolan">Macrolan</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#caracteristicas-de-macrolan">Características de macrolan</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">Arquitectura</a></li>
<li class="toctree-l3"><a class="reference internal" href="#arquitectura-red-de-acceso-vpls">Arquitectura: Red de acceso VPLS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#elementos-del-servicio">Elementos del servicio</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tipos-de-caudales">Tipos de caudales</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">Escenarios</a></li>
<li class="toctree-l3"><a class="reference internal" href="#calidad-de-servicio">Calidad de servicio</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="silan.html">Switching SILAN</a></li>
<li class="toctree-l1"><a class="reference internal" href="ibercom_ip.html">Servicio Ibercom IP</a></li>
</ul>
<p class="caption"><span class="caption-text">Terminales</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="audiocode.html">Configuración Audiocode</a></li>
<li class="toctree-l1"><a class="reference internal" href="dect_ascom.html">Configuración DECT Ascom</a></li>
<li class="toctree-l1"><a class="reference internal" href="gigaset.html">Gigaset IP DECT C530</a></li>
<li class="toctree-l1"><a class="reference internal" href="mediatrix.html">Configuración de Mediatrix</a></li>
<li class="toctree-l1"><a class="reference internal" href="dap_controller.html">IP DECT - DAP Controller</a></li>
<li class="toctree-l1"><a class="reference internal" href="ip_touch.html">Terminales IP TOUCH</a></li>
</ul>
<p class="caption"><span class="caption-text">Laboratorios</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="lab_wireshark.html">Laboratorios Wireshark</a></li>
</ul>
<p class="caption"><span class="caption-text">Estudio:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="presentaciones.html">Presentaciones</a></li>
<li class="toctree-l1"><a class="reference internal" href="doc.html">Documentación</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Wireshark</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Servicios de Redes Privadas de Cliente</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/rpv.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="servicios-de-redes-privadas-de-cliente">
<h1>Servicios de Redes Privadas de Cliente<a class="headerlink" href="#servicios-de-redes-privadas-de-cliente" title="Enlazar permanentemente con este título">¶</a></h1>
<div class="section" id="concepto-de-vpn">
<h2>Concepto de VPN<a class="headerlink" href="#concepto-de-vpn" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Existen muchas maneras de crear VPNs sobre entornos IP compartidos, como por ejemplo los túneles punto a punto o punto multipunto (existen numerosas tecnologías para crear dichos túneles) o las soluciones dinámicas basadas en MPLS VPN que se verán en puntos posteriores.</p>
<p>Las VPN basadas en túneles punto a punto tipo IPSEC, GREoIPSEC transportan los datos de cliente de forma securizada sobre Internet. Dichas VPN funcionan encapsulando el paquete IP original, que normalmente usa direccionamiento privado (RFC 1918), en un nuevo paquete IP con direccionamiento origen y destino público de tal manera que puede ser enrutado por Internet. El paquete original es encapsulado y cifrado proporcionando una comunicación securizada extremo a extremo (Autenticidad, Integridad y Confidencialidad). Observa la gráfica:</p>
<img alt="_static/imagenes/rpv-concepto.png" class="align-center" src="_static/imagenes/rpv-concepto.png" />
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Una VPN, Virtual Private Network, es un espacio de direccionamiento y datos privado sobre un entorno IP Público</p>
</div>
<p>Algunos ejemplos de tipos de túneles punto a punto son:</p>
<ul>
<li><p><strong>GRE</strong> que encapsula el paquete original (normalmente con direccionamiento privado) en un nuevo paquete IP con direccionamiento público (pero no cifra). Este tipo de túneles pueden transportar paquetes IP Multicast.</p></li>
<li><p><strong>IPsec</strong> encapsula y cifra el paquete original proporcionando una comunicación securizada extremo a extremo. No es compatible con IP Multicast.</p></li>
<li><p><strong>GREinsideIPsec</strong> la combinación de las 2 tecnologías anteriores proporciona un método de transporte cifrado sobre entornos IP Públicos que además es capaz de transportar paquetes IP Multicast.</p></li>
<li><p>Las soluciones de <strong>túneles multipunto</strong> tienen la capacidad de establecer un transporte sobre varios destinos de forma simultánea y dinámica. Algunos ejemplos de este tipo de tecnologías son:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>DMVPN</strong> construye VPNs multi-destino con posibilidad de cifrado y transporte de multicast. Es la base de la tecnología SD-WAN de Cisco.</p></li>
<li><p><strong>VXLAN</strong> construye VPNs multi-destino (para transporte de N3 y N2) y es la base de las soluciones SDN en DataCenter.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Existen otras soluciones de transporte con túneles IP multipunto para cubrir necesidades concretas como LISTP, OTV, L2TPV3</p></li>
</ul>
</div>
<div class="section" id="l3vpn">
<h2>L3VPN<a class="headerlink" href="#l3vpn" title="Enlazar permanentemente con este título">¶</a></h2>
<p>En todo caso estas soluciones no tienen la flexibilidad suficiente para crear VPNs (espacios de direccionamiento y datos privados de cliente) en entorno multitenant. Es decir, en entorno en el que deben convivir sobre una misma infraestructura IP compartida, las VPNs de distintos clientes.</p>
<p>Para dotar de una solución flexible a la creación de VPNs en el entorno Empresas sobre una infraestructura IP compartida el <a class="reference external" href="https://tools.ietf.org/html/rfc4364">RFC 4364</a> (solución del IETF) describe como la combinación de distintas tecnologías como MPLS (a nivel de transporte) o MultiProtocol-BGP, IS-IS o LDP (a nivel de señalización) da lugar a un método flexible y dinámico de creación y mantenimiento de VPNs sobre un Core IP compartido.Para dotar de una solución flexible a la creación de VPNs en el entorno Empresas sobre una infraestructura IP compartida el RFC 4364 (solución del IETF) describe como la combinación de distintas tecnologías como MPLS (a nivel de transporte) o MultiProtocol-BGP, IS-IS o LDP (a nivel de señalización) da lugar a un método flexible y dinámico de creación y mantenimiento de VPNs sobre un Core IP compartido.</p>
<div class="section" id="concepto-l3vpn-mpls">
<h3>Concepto L3VPN MPLS<a class="headerlink" href="#concepto-l3vpn-mpls" title="Enlazar permanentemente con este título">¶</a></h3>
<ul class="simple">
<li><p>Basada en el RFC 4364</p></li>
<li><p>Dos planos separados (señalización y Forwarding)</p></li>
<li><p>Señalización con MP-BGP (apoyado en IGP y LDP/RSVP)</p></li>
<li><p>Forwarding MPLS creación de túneles LSP automáticos</p></li>
</ul>
<img alt="_static/imagenes/vpn-l3vpn.png" class="align-center" src="_static/imagenes/vpn-l3vpn.png" />
</div>
<div class="section" id="elementos-que-componen-l3vpn-mpls">
<h3>Elementos que componen L3VPN MPLS<a class="headerlink" href="#elementos-que-componen-l3vpn-mpls" title="Enlazar permanentemente con este título">¶</a></h3>
<p>El RFC 4364 describe la arquitectura física/lógica para crear MPLS VPNs sobre un core IP compartido. En concreto los elementos que componen la infraestructura necesaria para crear un entorno MPLS VPN son los siguientes</p>
<p><strong>PES (Provider Edge)</strong></p>
<p>Son los elementos del borde de la red MPLS VPN que proporcionan conectividad con los routers de cliente. Sobre estos elementos reside la inteligencia de la red de forma distribuida. Su función, como se describirá con más detalle en puntos posteriores es separar los datos y direccionamiento de cliente en distintos espacios lógicos denominados VRFs (virtual routing and forwarding) e informar al resto de los Pes de la red del direccionamiento de cliente mediante sesiones de routing Multi-Protocol internal BGP. El direccionamiento de cliente es aprendido por algún protocolo de routing (BGP, OSPF, EIGRP, RIP, static) contra los routers de cliente. Por último, establecen sesiones de routing IGP (típicamente OSPF o IS-IS) con los Ps (Provider) cuya función es la de transportar la IP loopback que identifica a cada PE (y sobre la cual se establecen las sesiones MP-iBGP) para poder establecer la conectividad entre los PEs que conforman la red.</p>
<img alt="_static/imagenes/vpn-pes.png" class="align-center" src="_static/imagenes/vpn-pes.png" />
<p><strong>P (LSR)</strong></p>
<p>Entre los Ps (Providers) establecen sesiones IGP, OSPF o IS-IS en el caso del core de Teleéfonica para transportar la loopback que representa cada PE. Además, se intercambian etiquetas MPLS entre ellos y con los PEs mediante LDP con el propósito de establecer el transporte MPLS extremo a extremo. Estos elementos son los encargados de transportar los paquetes MPLS.</p>
<img alt="_static/imagenes/vpn-plsr.png" class="align-center" src="_static/imagenes/vpn-plsr.png" />
<p><strong>Reflectores de rutas</strong></p>
<p>Dadas las características de iBGP (protocolo de señalización usado para el enrutamiento entre PEs) se hace necesario un elemento extra en la arquitectura VPN. El Reflector de Rutas centraliza las sesiones MP-iBGP entre los Pes de otra manera los PEs deberían estar conectados full-mesh (todos con todos). En la reflexión de iBGP se añaden Path Attributes (router_orignitor y cluster_id) que sirven para evitar que pueda producirse un bucle en iBGP (ya que su comportamiento por defecto es no volver a reanunciar a otro nodo las rutas que ha aprendido por iBGP): router_orignitor y cluster_id.</p>
<img alt="_static/imagenes/vpn-reflectores-rutas.png" class="align-center" src="_static/imagenes/vpn-reflectores-rutas.png" />
</div>
<div class="section" id="senalizacion-l3vpn-mpls-mp-bgp">
<h3>Señalización L3VPN MPLS (MP-BGP)<a class="headerlink" href="#senalizacion-l3vpn-mpls-mp-bgp" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Podemos dividir el funcionamiento de una VPN MPLS en su plano de señalización y en su plano de forwarding (conmutación).</p>
<img alt="_static/imagenes/vpn-l3vpn-señalizacion.png" class="align-center" src="_static/imagenes/vpn-l3vpn-señalizacion.png" />
<p>Para la señalización, como ya se ha mencionado anteriormente, se usa el protocolo MP-iBGP entre los Pes (centralizado a través de los Reflectores de Rutas), IS-IS entre los Pes y los Ps y entre los Ps y LDP para la señalización MPLS</p>
<ol class="arabic simple">
<li><p><strong>NLRI</strong>: El prefijo que se está anunciando.</p></li>
<li><p><strong>RT</strong>: definido en el export de la VRF a la que pertenece el cliente.</p></li>
<li><p><strong>Site of Origin (SoO)</strong>: Identifica la sede desde la que se ha generado la ruta anunciada.</p></li>
<li><p><strong>Etiqueta MPLS</strong> (desmultiplexación) asignada por el PE a esa VRF (forma parte del NLRI).</p></li>
<li><p>El resto de atributos típicos de BGP: MED, Local Preference, AS Path</p></li>
</ol>
</div>
<div class="section" id="id1">
<h3>RFC 4364<a class="headerlink" href="#id1" title="Enlazar permanentemente con este título">¶</a></h3>
<p>La RFC 4364, resuelve las siguientes preguntas:</p>
<p><strong>¿Como separar las tablas de rutas de cada cliente?</strong></p>
<p>A cada cliente en el PE se le asigna una VRF, es decir, un plano de rutas individual y exclusivo. Dicha VRF se identifica por su Route-Distinguiser y define las políticas de importación y exportación de rutas.</p>
<img alt="_static/imagenes/vpn-rfc4364.png" class="align-center" src="_static/imagenes/vpn-rfc4364.png" />
<p><strong>¿Cómo saber a qué tabla de rutas pertenece cada ruta recibida?</strong></p>
<p>El Route Target es una communitie de MP BGP (un atributo que viaja con el anuncio MP BGP) que indica a que VRF pertenece esa ruta. En la política de exportación definida en la vrf se asigna el RT que se inserta en el anuncio de MP-BGP. Los demás Pes aprenderán dicha ruta según su política de importación de RT. En definitiva, si un PE recibe una ruta que pertence a un cliente que también tiene presencia en ese PE entonces aprenderá dicha ruta ya que habrá sido configurado para aprender el RT que viaja insertado en dicha ruta.</p>
<p>En cada vrf se define:</p>
<ul class="simple">
<li><p>Import RT: define que Route Targets aprendo.</p></li>
<li><p>Export RT: define que Route Targets anuncio.</p></li>
</ul>
<p><strong>¿Cómo hacer que las direcciones IP anunciadas sean únicas?</strong></p>
<p>El Route Distinguiser (64bits), definido en cada VRF, se añade por delante a la dirección IP (32 bits) para crear un nuevo prefijo (96 bits) único que no se solapa con el resto de clientes. La dirección resultante será VPNv4 (RD+IPv4) o VPNv6 (RD+IPv6). Por ejemplo,         en nuestro servicio, el RD para una ruta aprendida por MLAN es 3352:&lt;id_vpn&gt;01 y el RD para una ruta aprendida por VPN-IP es 3352:&lt;id_vpn&gt;00. De esta manera se crea un espacio de direccionamiento VPN único para cada cliente aun cuando su direccionamiento IP se solape.</p>
</div>
<div class="section" id="forwarding">
<h3>Forwarding<a class="headerlink" href="#forwarding" title="Enlazar permanentemente con este título">¶</a></h3>
<p><strong>¿Cómo se conmuta un paquete en la red MPLS?</strong></p>
<p>Gracias a la división del plano de rutas de los PEs en VRFs exclusivas para cada cliente y al MP-BGP se consigue que cada cliente únicamente conozca las rutas propias de ese cliente formando así una VPN.</p>
<p>Cuando se envía tráfico entran en juego los mecanismos de forwarding basados en MPLS y que se apoyan en todo lo anterior (MP-BGP y VRFs).</p>
<p>Son necesarias (al menos) 2 etiquetas MPLS para hacer el forwarding de los paquetes:</p>
<ul class="simple">
<li><p>Una etiqueta que indica el PE destino (Egrees PE label). Los Ps únicamente se fijan en esta etiqueta para hacer conmutar el paquete. Es aprendida por LDP.</p></li>
<li><p>Una etiqueta (Demultiplexion Label) que indica cual es la VRF destino dentro del PE destino (VPN label). La anuncia el PE destino como parte del update MP-BGP.</p></li>
</ul>
<img alt="_static/imagenes/vpn-ibgp-update.png" class="align-center" src="_static/imagenes/vpn-ibgp-update.png" />
<img alt="_static/imagenes/vpn-mpls-vpn.png" class="align-center" src="_static/imagenes/vpn-mpls-vpn.png" />
</div>
<div class="section" id="servicios-rpv">
<h3>Servicios RPV<a class="headerlink" href="#servicios-rpv" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Basado en los puntos anteriores en los que se describe como funciona una arquitectura VPN MPLS los servicios de RPV (Red Privada Virtual) ofrecidos por Telefónica proporcionan conectividad a los clientes del sector Empresas. Esta conectividad entre sedes de Empresas se forma mediante tecnología MPLS VPN dotando a los servicios de RPV de las siguientes características:</p>
<ul class="simple">
<li><p><strong>Seguridad</strong>, Las redes MPLS VPN son seguras por sí mismas sin necesidad, salvo requerimiento de cliente, de tecnologías de cifrado como IPsec. El tráfico de cliente es encapsulado extremo a extremo en un túnel MPLS (LSP) desde el PE origen hasta el PE destino.</p></li>
<li><p><strong>Flexibilidad</strong>, Las redes MPLS VPN son flexibles y dinámicas ya que para añadir una sede nueva a la topología del cliente únicamente hay que definir en el PE correspondiente la VRF de cliente. La señalización subyacente (MultiProtocol-BGP, LDP e IS-IS) proporcionan el plano de control necesario para dotar de conectividad a las nuevas sedes de cliente.</p></li>
<li><p><strong>Topología</strong>, La conectividad de las sedes de cliente será Full-Mesh, es decir, las sedes se podrán conectar todas con todas salvo requerimiento específico de cliente. Como proyecto especial se pueden definir topologías Hub&amp;Spoke en las que la conectividad de cliente está centralizada a través de un Punto Central.</p></li>
<li><p><strong>Integración</strong>, Los servicios de RPV basados en MPLS VPN permiten distintas tecnologías de acceso para los clientes como se detallará en puntos posteriores. Fibra Directa, Fibra Multiplexada (FTTH), 3g/4g y tecnologías ya descatalogadas como ATM o FR.</p></li>
<li><p><strong>Extensión</strong>, Las redes basadas en MPLS VPN pueden extenderse fácilmente a través de Puntos de Interconexión (PoI) para conectar sedes que están en distintos dominios MPLS. Un ejemplo de ello es la extensión MPLS que existe entre la red de Telefónica de España y la red de TIWS para conectar sedes internacionales.</p></li>
</ul>
<p>Comercialmente hay dos servicios de RPV de Empresas, VPN-IP y MacroLAN. En siguientes apartados se explicarán las diferencias entre ambos servicios que fundamentalmente radican en la tecnología de acceso</p>
<img alt="_static/imagenes/vpn-mlan-vpnip.png" class="align-center" src="_static/imagenes/vpn-mlan-vpnip.png" />
</div>
<div class="section" id="red-de-trnasporte">
<h3>Red de trnasporte<a class="headerlink" href="#red-de-trnasporte" title="Enlazar permanentemente con este título">¶</a></h3>
<p>El núcleo de transporte de la red MPLS VPN está formada por 8 centros de transporte en los que se disponen de 2 nodos de tránsito (denominados Ps en la arquitectura MPLS VPN). Las características de esta red de transporte son:</p>
<ul class="simple">
<li><p><strong>Alta Disponibilidad</strong>: La red de transporte funciona como una doble malla con redundancia de enlaces y equipos. Los enlaces y equipos están continuamente monitorizados de tal manera que no se supere el 40% de carga en ningún momento para asegurar que, en caso de fallo, se puede reabsorber el tráfico.</p></li>
<li><p><strong>Alta Capacidad</strong>: Los enlaces entre centros de transporte son de 10G y 100G estando redundados por triplicado o cuadruplicado.</p></li>
<li><p><strong>Red IP única</strong>: Esta red da soporte a los servicios de RPV de Empresas así como a los servicios de Internet Empresas e Internet Residencial.</p></li>
</ul>
<img alt="_static/imagenes/vpn-transporte.png" class="align-center" src="_static/imagenes/vpn-transporte.png" />
</div>
</div>
<div class="section" id="servicio-vpn-ip">
<h2>Servicio VPN-IP<a class="headerlink" href="#servicio-vpn-ip" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="section" id="caracteristicas-del-servicio-vpn-ip">
<h3>Caracteristicas del servicio VPN-IP<a class="headerlink" href="#caracteristicas-del-servicio-vpn-ip" title="Enlazar permanentemente con este título">¶</a></h3>
<p><strong>EDC gestionado por telefónica</strong></p>
<p>El EDC (Equipo de Cliente) está monitorizado y gestionado en modo servicio por Telefónica.</p>
<p><strong>Tecnologías de acceso</strong></p>
<p>Las tecnologías de acceso que corresponden con el servicio VPN-IP son:</p>
<ul class="simple">
<li><p>FTTH</p></li>
<li><p>ADSL IP</p></li>
<li><p>ADSL ATM (descatalogado)</p></li>
<li><p>Acceso Móvil (3g/4g).</p></li>
</ul>
<p><strong>Calidad de servicio</strong></p>
<p>Se ofrecen 4 tipos de clases de servicio orientadas a distintos grados de criticidad del tráfico de cliente en cuanto a retardo, jitter y priorización. Las clases de servicio son:</p>
<ul class="simple">
<li><p>Multimedia</p></li>
<li><p>Oro</p></li>
<li><p>Plata</p></li>
<li><p>Bronce</p></li>
</ul>
<p><strong>SLA</strong></p>
<p>El servicio VPN-IP, al ser un servicio gestionado de RPV ofrece una serie de SLAs, algunas de ellas son las siguientes:</p>
<ul class="simple">
<li><p>Plazo de Entrega de Oficina</p></li>
<li><p>Disponibilidad de Oficina</p></li>
<li><p>Pérdida de Paquetes</p></li>
<li><p>Retardo de Tránsito en red IP</p></li>
<li><p>Jitter EN RED IP</p></li>
<li><p>Tiempo medio de respuesta a averías</p></li>
</ul>
</div>
<div class="section" id="arquitectura">
<h3>Arquitectura<a class="headerlink" href="#arquitectura" title="Enlazar permanentemente con este título">¶</a></h3>
<ul class="simple">
<li><p>Las rutas de cliente se exportan hacia la red con un RT definido en función del VPN ID (otorgado por los sistemas).</p></li>
<li><p>La vrf de cliente en el PE aprende las rutas que importan el RT definido (en función del VPN ID) para ese cliente.</p></li>
</ul>
<img alt="_static/imagenes/rpv-vpnip.png" class="align-center" src="_static/imagenes/rpv-vpnip.png" />
</div>
<div class="section" id="tipos-de-acceso">
<h3>Tipos de acceso<a class="headerlink" href="#tipos-de-acceso" title="Enlazar permanentemente con este título">¶</a></h3>
<p>En cuanto a los tipos de tecnologías de acceso que ofrece el servicio VPN-IP tenemos:</p>
<p><strong>ADSL sobre IP</strong></p>
<p>En este tipo de acceso se establece la conectividad IP entre el router de cliente y el PE (denominado BRAS en estas tipologías) sobre una conectividad punto a punto PPP.</p>
<p>El nodo de entrada a la central se denomina DSLAM-IP y la conectividad entre el DSLAM IP y el PE/BRAS se proporciona sobre la red Ethernet de acceso Metropolitano.</p>
<img alt="_static/imagenes/rpv-vpnip-adsl.png" class="align-center" src="_static/imagenes/rpv-vpnip-adsl.png" />
<p><strong>ADSL2+ sobre IP</strong></p>
<p>Además de cambiar la tecnología de conectividad entre el router de cliente y el DSLAM a ADSL2+ se cambia la suite de protocolos de conectividad entre el DSLAM-IP y el PE.</p>
<p>En ADSL se basa en conexiones PPP y en ADSL2+ se basa en QinQ también sobre la red de acceso Metropolitana.</p>
<img alt="_static/imagenes/rpv-vpnip-adsl2.png" class="align-center" src="_static/imagenes/rpv-vpnip-adsl2.png" />
<p><strong>FTTH</strong></p>
<p>Con este modelo de conectividad, en el que se alcanzan hasta velocidades de 300Mbps simétricos el router de cliente se conecta a la ONT que hace de pasarela eléctrica-óptica entre el router de cliente y la conectividad contra la central basada en fibra multiplexada GPON.</p>
<p>La OLT es el punto de entrada a la red Ethernet de acceso metropolitana que conecta con la red de transporte IP.</p>
<img alt="_static/imagenes/rpv-vpnip-ftth.png" class="align-center" src="_static/imagenes/rpv-vpnip-ftth.png" />
<p><strong>Accesos móviles</strong></p>
<p>Otra de las modalidades de conectividad del servicio VPN-IP son los accesos radio celulares. Con accesos de tipo 3G/4G no se pueden dar garantías de caudal ni priorizar cierto tráfico frente a otro mediante la implementación de distintas calidades de servicio.</p>
<img alt="_static/imagenes/rpv-vpnip-movil.png" class="align-center" src="_static/imagenes/rpv-vpnip-movil.png" />
</div>
<div class="section" id="equipamiento-y-tipos-de-aceso">
<h3>Equipamiento y tipos de aceso<a class="headerlink" href="#equipamiento-y-tipos-de-aceso" title="Enlazar permanentemente con este título">¶</a></h3>
<p>El servicio de VPN-IP se ofrece sobre 3 fabricantes distintos:</p>
<ul class="simple">
<li><p>Cisco.</p></li>
<li><p>Teldat.</p></li>
<li><p>One Access.</p></li>
</ul>
<p>El Manual Comercial de EDCs desglosa los modelos de router disponibles por cada tipo de acceso, así como las características técnicas de cada uno de ellos. La referencia de los EDCs homologados en VPN-IP se puede encontrar en el Manual Comercial de EDCs.</p>
<img alt="_static/imagenes/rpv-vpnip-equipos.png" class="align-center" src="_static/imagenes/rpv-vpnip-equipos.png" />
</div>
<div class="section" id="escenarios">
<h3>Escenarios<a class="headerlink" href="#escenarios" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Los escenarios admitidos en el servicio VPN-IP cubren las distintas necesidades de cliente en cuanto a Disponibilidad y Balanceo de tráfico entre distintos accesos.</p>
<p><strong>EDC y único acceso</strong></p>
<img alt="_static/imagenes/rpv-vpnip-1.png" class="align-center" src="_static/imagenes/rpv-vpnip-1.png" />
<p><strong>EDC único y doble acceso en modo principal-back up</strong>: en esta tipología el acceso de back-up absorbe el tráfico en caso de caída del acceso principal</p>
<p><strong>EDC único y doble acceso en modo balanceo</strong>: en esta disposición el tráfico de cliente se reparte entre ambos accesos. Además, en caso de caída de un acceso el otro absorbe todo el tráfico.</p>
<img alt="_static/imagenes/rpv-vpnip-2.png" class="align-center" src="_static/imagenes/rpv-vpnip-2.png" />
<p><strong>EDC doble y doble acceso en modo principal-back up</strong>: en esta tipología además de tener redundancia a nivel de acceso hay redundancia a nivel de EDC</p>
<img alt="_static/imagenes/rpv-vpnip-3.png" class="align-center" src="_static/imagenes/rpv-vpnip-3.png" />
<p><strong>EDC doble y doble acceso en modo balanceo</strong>: en este caso, a la topología de balanceo se añade la redundancia de EDC</p>
<img alt="_static/imagenes/rpv-vpnip-4.png" class="align-center" src="_static/imagenes/rpv-vpnip-4.png" />
</div>
<div class="section" id="id2">
<h3>Servicio VPN-IP<a class="headerlink" href="#id2" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Además de las distintas tipologías de acceso se ofrecen otras funcionalidades dentro del servicio VPN-IP:</p>
<p><strong>Calidad de servicio</strong></p>
<p>Como se ha descrito en puntos anteriores se ofrecen distintas clases de servicio (multimedia, oro, plata, bronce) además de conformado de tráfico mediante shaping.</p>
<p>Cada una de las calidades de servicio ofrece un tratamiento diferencial del flujo de tráfico extremo a extremo.</p>
<img alt="_static/imagenes/rpv-vpnip-qos.png" class="align-center" src="_static/imagenes/rpv-vpnip-qos.png" />
<p><strong>Cifrado</strong></p>
<ul class="simple">
<li><p>Cifrado IPsec extremo a extremo (CE to CE)</p></li>
<li><p>Modo túnel (cifrando cabeceras, secreto compartido, 3DES</p></li>
<li><p>Soporte DLSW (encapsulado de SNA-IBM en IP) y XoT (encapsulado de X.25 en TCP)</p></li>
</ul>
<img alt="_static/imagenes/rpv-vpnip-cifrado.png" class="align-center" src="_static/imagenes/rpv-vpnip-cifrado.png" />
<p><strong>Otras facilidades</strong></p>
<p>Existen una serie de facilidades especiales definidas dentro de las plantillas de configuraciones especiales del servicio VPN-IP:</p>
<ul class="simple">
<li><p>DHCP relay</p></li>
<li><p>DHCP server</p></li>
<li><p>Policy Based Routing</p></li>
<li><p>Listas de acceso</p></li>
<li><p>GLBP (como protocolo alternativo a HSRP/VRRP)</p></li>
<li><p>WIFI (solo con CGP)</p></li>
</ul>
</div>
</div>
<div class="section" id="macrolan">
<h2>Macrolan<a class="headerlink" href="#macrolan" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>El servicio MacroLAN, al igual que el servicio VPN-IP, se basa en crear una VPN MPLS sobre el Core IP permitiendo la conectividad entre las sedes de cliente</p>
</div>
<p>La principal diferencia con el servicio VPN-IP es la tipología del acceso. En el caso de Macrolan se usan Fibra Directa hasta la red de acceso Metropolitana. Otra modalidad es la fibra directa al PE sin transitar por la red Metropolitana Ethernet.</p>
<p>El servicio Macrolan presenta muchas similitudes con el servicio VPN-IP.</p>
<div class="section" id="caracteristicas-de-macrolan">
<h3>Características de macrolan<a class="headerlink" href="#caracteristicas-de-macrolan" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Algunas de las características que definen este servicio son:</p>
<p><strong>EDC gestionado</strong></p>
<p><strong>Acceso a la red Metropolitana de transporte Ethernet</strong></p>
<p>Recuerda que en el servicio VPN-IP las conexiones son punto a punto (sobre la rede de acceso Metropolitana) contra el PE de acceso al core IP,</p>
<p>El servicio MacroLAN se basa en una conectividad multipunto sobre la red de acceso Ethernet, permitiendo que las sedes de cliente (que estén dentro de la misma red Metropolitana) se conecten a nivel Ethernet.</p>
<p><strong>Topología mallada full-mesh</strong></p>
<p>Con esta topología, todas las sedes pueden verse entre sí directamente.</p>
<p>También se admiten topologías Hub&amp;Spoke como proyecto especial.</p>
<p><strong>Facilidades de redundancia</strong></p>
<p>Facilidades de redundancia con topologías con único EDC o doble EDC.</p>
<p><strong>Calidad de servicio</strong></p>
<p>Al igual que en el servicio VPN-IP, se ofrecen 4 calidades de servicio (Multimedia, Oro, Plata y Bronce) para hacer un tratamiento diferenciado del tráfico de cliente según su nivel de criticidad.</p>
<p><strong>SLAs</strong></p>
<p>El servicio ofrece una serie de SLAs.</p>
<p><strong>Facilidades de cifrado</strong></p>
<p>Facilidades de cifrado para aquellos clientes que necesiten un nivel extra de seguridad en su conectividad.</p>
</div>
<div class="section" id="id3">
<h3>Arquitectura<a class="headerlink" href="#id3" title="Enlazar permanentemente con este título">¶</a></h3>
<ul class="simple">
<li><p>Las vrf de cliente exportan hacia la red las rutas con RT definido a partir del VPN ID.</p></li>
<li><p>Las vrf de cliente importan las rutas que tienen el RT (en función del VPN ID) definido para ese cliente.</p></li>
</ul>
<img alt="_static/imagenes/rpv-macrolan.png" class="align-center" src="_static/imagenes/rpv-macrolan.png" />
</div>
<div class="section" id="arquitectura-red-de-acceso-vpls">
<h3>Arquitectura: Red de acceso VPLS<a class="headerlink" href="#arquitectura-red-de-acceso-vpls" title="Enlazar permanentemente con este título">¶</a></h3>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>La red de Acceso Metropolitana (MAN) proporciona conectividad Ethernet sobre un core MPLS</p>
</div>
<p>A diferencia del core IP de transporte nacional en el que los túneles MPLS transportan paquetes IP, la red de acceso Metropolitana transporta tramas Ethernet sobre conectividad MPLS. En concreto, la tecnología usada para el transporte de Ethernet sobre MPLS es H-VPLS.</p>
<p>La arquitectura de una red H-VPLS se basa en 3 niveles</p>
<ul class="simple">
<li><p>PEs de acceso (MTU) que conectan con los routers de cliente.</p></li>
<li><p>PEs que interconectan el nivel de acceso con el nivel de agregación.</p></li>
<li><p>PEs de agregación.</p></li>
</ul>
<p>La principal diferencia entre el servicio VPN-IP y el servicio MLAN es la red de accesos a la red IP/MPLS.</p>
<p>En MLAN la red de acceso es una red H-VPLS.</p>
<p>VPLS proporciona un servicio de transporte Ethernet sobre un core MPLS.</p>
<p>Soportada en equipamiento de Alcatel-Lucent (ALU) y Huawe</p>
<img alt="_static/imagenes/rpv-mlan.png" class="align-center" src="_static/imagenes/rpv-mlan.png" />
<p>Actualmente el mapa que corresponde con las distintas redes de acceso Metropolitanas es el representado en la figura.</p>
<p>Los fabricantes que implementan estas redes metropolitanas son Huawei y Alcatel.</p>
<p>A día de hoy se está implementando un proceso gradual de transformación de la red en la que las redes Metropolitanas desaparecerán extendiendo el core IP hasta el extremo del router de cliente</p>
<img alt="_static/imagenes/rpv-mlan-mapa.png" class="align-center" src="_static/imagenes/rpv-mlan-mapa.png" />
</div>
<div class="section" id="elementos-del-servicio">
<h3>Elementos del servicio<a class="headerlink" href="#elementos-del-servicio" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Los elementos que componen la arquitectura del servicio MacroLAN son los siguientes:</p>
<p><strong>Equipamiento</strong></p>
<p>Los EDCs homologados para el servicio MacroLAN están detallados en el Manual Comercial de EDCs y cubren velocidades de acceso desde los 10Mbps hasta los 10Gbps para entornos de DataCenter.</p>
<p>Los fabricantes homologados para el servicio MacroLAN son:</p>
<ul class="simple">
<li><p>Cisco</p></li>
<li><p>Teldat</p></li>
<li><p>OneAccess</p></li>
<li><p>HP</p></li>
</ul>
<p><strong>Circuitos de acceso</strong></p>
<p>Los circuitos de acceso (desde el EDC en domicilio de cliente hasta el nodo de entrada a la MAN (MTU) pueden ser:</p>
<ul class="simple">
<li><p>Accesos de Cobre (CobreLAN) de 2,4 y 8Mbps</p></li>
<li><p>Accesos de Fibra de 10Mbps</p></li>
<li><p>Accesos de Fibra de 100Mbps</p></li>
<li><p>Accesos de Fibra de 1Gbps</p></li>
<li><p>Accesos de Fibra de 10Gbps</p></li>
</ul>
</div>
<div class="section" id="tipos-de-caudales">
<h3>Tipos de caudales<a class="headerlink" href="#tipos-de-caudales" title="Enlazar permanentemente con este título">¶</a></h3>
<p><strong>Caudal metro</strong></p>
<p>Es el caudal contratado en salida del EDC hacia la red. Esta caudal es consumido sea cual sea el destino, en la misma red Metro o en otra red Metro con lo que el tráfico debe transitar por el core IP.</p>
<p><strong>Caudal nacional agregado</strong></p>
<p>Es el caudal consumido y compartido por los EDCs de cliente de una provincia con destino a otras provincias. Este caudal se configura en sentido entrada en los PEs del Core IP MPLS.</p>
<p><strong>Caudal nacional exclusivo</strong></p>
<p>Este caudal se tramita cuando se desea aislar a una sede de cliente, a nivel Metropolitano, del resto de sedes de cliente en la misma provincia. Esto obliga a que todo el tráfico con origen o destino dicha sede, ya sea en la misma o distinta provincia se curse a través del PE</p>
<p><strong>Caudal CDG agregado</strong></p>
<p>Este caudal es consumido y compartido por las sedes de una provincia cuyo tráfico se destina a los CDGs. También es consumido por el tráfico originado en el propio CDG</p>
<p><strong>Caudal CDG exclusivo</strong></p>
<p>Este caudal es consumido por una sede individual con origen o destino el CDG cuando no se desea que el caudal CDG sea compartido por los EDCs de la misma provincia</p>
<img alt="_static/imagenes/rpv-mlan-elementos2.png" class="align-center" src="_static/imagenes/rpv-mlan-elementos2.png" />
</div>
<div class="section" id="id4">
<h3>Escenarios<a class="headerlink" href="#id4" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Las topologías de las sedes en cuanto a su nivel de redundancia son los siguientes:</p>
<p><strong>EDC único y acceso único</strong></p>
<img alt="_static/imagenes/rpv-mlan-unico.png" class="align-center" src="_static/imagenes/rpv-mlan-unico.png" />
<p><strong>EDC doble, principal-backup</strong></p>
<img alt="_static/imagenes/rpv-mlan-doble.png" class="align-center" src="_static/imagenes/rpv-mlan-doble.png" />
<p><strong>EDC único y aceso doble</strong></p>
<img alt="_static/imagenes/rpv-mlan-unico2.png" class="align-center" src="_static/imagenes/rpv-mlan-unico2.png" />
<p><strong>EDC doble. Reparto de carga</strong></p>
<img alt="_static/imagenes/rpv-mlan-doble2.png" class="align-center" src="_static/imagenes/rpv-mlan-doble2.png" />
</div>
<div class="section" id="calidad-de-servicio">
<h3>Calidad de servicio<a class="headerlink" href="#calidad-de-servicio" title="Enlazar permanentemente con este título">¶</a></h3>
<img alt="_static/imagenes/rpv-mlan-qos.png" class="align-center" src="_static/imagenes/rpv-mlan-qos.png" />
<ul class="simple">
<li><p>Clase plata, clase por defecto orientada al tráfico internet</p></li>
<li><p>Clase oro, orientada al tráfico internet</p></li>
<li><p>Clase multimedia. orientada al tráfico sensible a retardo (VoIP), prioriza respecto al resto de clases</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Reserva de caudal plata: permite que el cliente pueda hacer una reserva dentro del caudal plata que tuviera contratado para que dicho caudal esté disponible para cursar un determinado tipo de tráfico en caso de congestión del acceso del EDC con la MAN en sentido hacia la MAN</p>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="silan.html" class="btn btn-neutral float-right" title="Switching SILAN" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="rtp.html" class="btn btn-neutral float-left" title="Protocolo RTP" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Kike G

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>